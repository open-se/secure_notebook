"use strict";

var _path = _interopRequireDefault(require("path"));

var _electron = require("electron");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const isDevelopment = process.env.NODE_ENV === 'development';
let mainWindow = null;
let forceQuit = false;

const installExtensions = async () => {
  const installer = require('electron-devtools-installer');

  const extensions = ['REACT_DEVELOPER_TOOLS', 'REDUX_DEVTOOLS'];
  const forceDownload = !!process.env.UPGRADE_EXTENSIONS;

  for (const name of extensions) {
    try {
      await installer.default(installer[name], forceDownload);
    } catch (e) {
      console.log(`Error installing ${name} extension: ${e.message}`);
    }
  }
};

global.loadLoginMenu = () => {
  console.log("Loading Login Menu");
  const template = [{
    label: "File",
    submenu: [{
      label: 'Exit',
      role: 'quit'
    }]
  }];

  _electron.Menu.setApplicationMenu(_electron.Menu.buildFromTemplate(template));
};

global.loadLoggedInMenu = () => {
  console.log("Loading Logged In Menu");
  const template = [{
    label: "File",
    submenu: [{
      label: 'Exit',
      role: 'quit'
    }, {
      label: 'Logout',
      role: 'logout'
    }]
  }];

  _electron.Menu.setApplicationMenu(_electron.Menu.buildFromTemplate(template));
};

_electron.crashReporter.start({
  productName: 'YourName',
  companyName: 'YourCompany',
  submitURL: 'https://your-domain.com/url-to-submit',
  uploadToServer: false
});

_electron.app.on('window-all-closed', () => {
  // On OS X it is common for applications and their menu bar
  // to stay active until the user quits explicitly with Cmd + Q
  if (process.platform !== 'darwin') {
    _electron.app.quit();
  }
});

_electron.app.on('ready', async () => {
  if (isDevelopment) {
    await installExtensions();
  }

  mainWindow = new _electron.BrowserWindow({
    width: 1000,
    height: 800,
    minWidth: 640,
    minHeight: 480,
    show: false,
    webPreferences: {
      nodeIntegration: true
    },
    frame: false
  });
  mainWindow.loadFile(_path.default.resolve(_path.default.join(__dirname, '../renderer/index.html'))); // show window once on first load

  mainWindow.webContents.once('did-finish-load', () => {
    mainWindow.show();
  });
  mainWindow.webContents.on('did-finish-load', () => {
    // Handle window logic properly on macOS:
    // 1. App should not terminate if window has been closed
    // 2. Click on icon in dock should re-open the window
    // 3. âŒ˜+Q should close the window and quit the app
    if (process.platform === 'darwin') {
      mainWindow.on('close', function (e) {
        if (!forceQuit) {
          e.preventDefault();
          mainWindow.hide();
        }
      });

      _electron.app.on('activate', () => {
        mainWindow.show();
      });

      _electron.app.on('before-quit', () => {
        forceQuit = true;
      });
    } else {
      mainWindow.on('closed', () => {
        mainWindow = null;
      });
    }
  });

  if (isDevelopment) {
    // auto-open dev tools
    mainWindow.webContents.openDevTools(); // add inspect element on right click menu

    mainWindow.webContents.on('context-menu', (e, props) => {
      _electron.Menu.buildFromTemplate([{
        label: 'Inspect element',

        click() {
          mainWindow.inspectElement(props.x, props.y);
        }

      }]).popup(mainWindow);
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4vaW5kZXguanMiXSwibmFtZXMiOlsiaXNEZXZlbG9wbWVudCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsIm1haW5XaW5kb3ciLCJmb3JjZVF1aXQiLCJpbnN0YWxsRXh0ZW5zaW9ucyIsImluc3RhbGxlciIsInJlcXVpcmUiLCJleHRlbnNpb25zIiwiZm9yY2VEb3dubG9hZCIsIlVQR1JBREVfRVhURU5TSU9OUyIsIm5hbWUiLCJkZWZhdWx0IiwiZSIsImNvbnNvbGUiLCJsb2ciLCJtZXNzYWdlIiwiZ2xvYmFsIiwibG9hZExvZ2luTWVudSIsInRlbXBsYXRlIiwibGFiZWwiLCJzdWJtZW51Iiwicm9sZSIsIk1lbnUiLCJzZXRBcHBsaWNhdGlvbk1lbnUiLCJidWlsZEZyb21UZW1wbGF0ZSIsImxvYWRMb2dnZWRJbk1lbnUiLCJjcmFzaFJlcG9ydGVyIiwic3RhcnQiLCJwcm9kdWN0TmFtZSIsImNvbXBhbnlOYW1lIiwic3VibWl0VVJMIiwidXBsb2FkVG9TZXJ2ZXIiLCJhcHAiLCJvbiIsInBsYXRmb3JtIiwicXVpdCIsIkJyb3dzZXJXaW5kb3ciLCJ3aWR0aCIsImhlaWdodCIsIm1pbldpZHRoIiwibWluSGVpZ2h0Iiwic2hvdyIsIndlYlByZWZlcmVuY2VzIiwibm9kZUludGVncmF0aW9uIiwiZnJhbWUiLCJsb2FkRmlsZSIsInBhdGgiLCJyZXNvbHZlIiwiam9pbiIsIl9fZGlybmFtZSIsIndlYkNvbnRlbnRzIiwib25jZSIsInByZXZlbnREZWZhdWx0IiwiaGlkZSIsIm9wZW5EZXZUb29scyIsInByb3BzIiwiY2xpY2siLCJpbnNwZWN0RWxlbWVudCIsIngiLCJ5IiwicG9wdXAiXSwibWFwcGluZ3MiOiI7O0FBQUE7O0FBQ0E7Ozs7QUFFQSxNQUFNQSxhQUFhLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxRQUFaLEtBQXlCLGFBQS9DO0FBRUEsSUFBSUMsVUFBVSxHQUFHLElBQWpCO0FBQ0EsSUFBSUMsU0FBUyxHQUFHLEtBQWhC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QUEwQyxDQUFDckIsQ0FBRCxFQUFJMkMsS0FBSixLQUFjO0FBQ3REakMscUJBQUtFLGlCQUFMLENBQXVCLENBQ3JCO0FBQ0VMLFFBQUFBLEtBQUssRUFBRSxpQkFEVDs7QUFFRXFDLFFBQUFBLEtBQUssR0FBRztBQUNOdEQsVUFBQUEsVUFBVSxDQUFDdUQsY0FBWCxDQUEwQkYsS0FBSyxDQUFDRyxDQUFoQyxFQUFtQ0gsS0FBSyxDQUFDSSxDQUF6QztBQUNEOztBQUpILE9BRHFCLENBQXZCLEVBT0dDLEtBUEgsQ0FPUzFELFVBUFQ7QUFRRCxLQVREO0FBVUQ7QUFHRixDQXJFRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xyXG5pbXBvcnQgeyBhcHAsIGNyYXNoUmVwb3J0ZXIsIEJyb3dzZXJXaW5kb3csIE1lbnUgfSBmcm9tICdlbGVjdHJvbic7XHJcblxyXG5jb25zdCBpc0RldmVsb3BtZW50ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCc7XHJcblxyXG5sZXQgbWFpbldpbmRvdyA9IG51bGw7XHJcbmxldCBmb3JjZVF1aXQgPSBmYWxzZTtcclxuXHJcbmNvbnN0IGluc3RhbGxFeHRlbnNpb25zID0gYXN5bmMgKCkgPT4ge1xyXG4gIGNvbnN0IGluc3RhbGxlciA9IHJlcXVpcmUoJ2VsZWN0cm9uLWRldnRvb2xzLWluc3RhbGxlcicpO1xyXG4gIGNvbnN0IGV4dGVuc2lvbnMgPSBbJ1JFQUNUX0RFVkVMT1BFUl9UT09MUycsICdSRURVWF9ERVZUT09MUyddO1xyXG4gIGNvbnN0IGZvcmNlRG93bmxvYWQgPSAhIXByb2Nlc3MuZW52LlVQR1JBREVfRVhURU5TSU9OUztcclxuICBmb3IgKGNvbnN0IG5hbWUgb2YgZXh0ZW5zaW9ucykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgaW5zdGFsbGVyLmRlZmF1bHQoaW5zdGFsbGVyW25hbWVdLCBmb3JjZURvd25sb2FkKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5sb2coYEVycm9yIGluc3RhbGxpbmcgJHtuYW1lfSBleHRlbnNpb246ICR7ZS5tZXNzYWdlfWApO1xyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcblxyXG5nbG9iYWwubG9hZExvZ2luTWVudSA9ICgpID0+e1xyXG4gIGNvbnNvbGUubG9nKFwiTG9hZGluZyBMb2dpbiBNZW51XCIpO1xyXG4gIGNvbnN0IHRlbXBsYXRlID0gW1xyXG4gICAgICB7XHJcbiAgICAgIGxhYmVsOiBcIkZpbGVcIixcclxuICAgICAgc3VibWVudTogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgbGFiZWw6ICdFeGl0JyxcclxuICAgICAgICAgIHJvbGU6ICdxdWl0J1xyXG4gICAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgICAgIH1cclxuICBdO1xyXG4gIE1lbnUuc2V0QXBwbGljYXRpb25NZW51KE1lbnUuYnVpbGRGcm9tVGVtcGxhdGUodGVtcGxhdGUpKTtcclxufVxyXG5cclxuZ2xvYmFsLmxvYWRMb2dnZWRJbk1lbnUgPSAoKSA9PntcclxuICBjb25zb2xlLmxvZyhcIkxvYWRpbmcgTG9nZ2VkIEluIE1lbnVcIik7XHJcbiAgY29uc3QgdGVtcGxhdGUgPSBbXHJcbiAgICAgIHtcclxuICAgICAgbGFiZWw6IFwiRmlsZVwiLFxyXG4gICAgICBzdWJtZW51OiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICBsYWJlbDogJ0V4aXQnLFxyXG4gICAgICAgICAgcm9sZTogJ3F1aXQnXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICAgIGxhYmVsOiAnTG9nb3V0JyxcclxuICAgICAgICAgICAgICByb2xlOiAnbG9nb3V0J1xyXG4gICAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgICAgIH1cclxuICBdO1xyXG4gIE1lbnUuc2V0QXBwbGljYXRpb25NZW51KE1lbnUuYnVpbGRGcm9tVGVtcGxhdGUodGVtcGxhdGUpKTtcclxufVxyXG5cclxuY3Jhc2hSZXBvcnRlci5zdGFydCh7XHJcbiAgcHJvZHVjdE5hbWU6ICdZb3VyTmFtZScsXHJcbiAgY29tcGFueU5hbWU6ICdZb3VyQ29tcGFueScsXHJcbiAgc3VibWl0VVJMOiAnaHR0cHM6Ly95b3VyLWRvbWFpbi5jb20vdXJsLXRvLXN1Ym1pdCcsXHJcbiAgdXBsb2FkVG9TZXJ2ZXI6IGZhbHNlLFxyXG59KTtcclxuXHJcbmFwcC5vbignd2luZG93LWFsbC1jbG9zZWQnLCAoKSA9PiB7XHJcbiAgLy8gT24gT1MgWCBpdCBpcyBjb21tb24gZm9yIGFwcGxpY2F0aW9ucyBhbmQgdGhlaXIgbWVudSBiYXJcclxuICAvLyB0byBzdGF5IGFjdGl2ZSB1bnRpbCB0aGUgdXNlciBxdWl0cyBleHBsaWNpdGx5IHdpdGggQ21kICsgUVxyXG4gIGlmIChwcm9jZXNzLnBsYXRmb3JtICE9PSAnZGFyd2luJykge1xyXG4gICAgYXBwLnF1aXQoKTtcclxuICB9XHJcbn0pO1xyXG5cclxuYXBwLm9uKCdyZWFkeScsIGFzeW5jICgpID0+IHtcclxuICBpZiAoaXNEZXZlbG9wbWVudCkge1xyXG4gICAgYXdhaXQgaW5zdGFsbEV4dGVuc2lvbnMoKTtcclxuICB9XHJcblxyXG4gIG1haW5XaW5kb3cgPSBuZXcgQnJvd3NlcldpbmRvdyh7XHJcbiAgICB3aWR0aDogMTAwMCxcclxuICAgIGhlaWdodDogODAwLFxyXG4gICAgbWluV2lkdGg6IDY0MCxcclxuICAgIG1pbkhlaWdodDogNDgwLFxyXG4gICAgc2hvdzogZmFsc2UsXHJcbiAgICB3ZWJQcmVmZXJlbmNlczoge1xyXG4gICAgICBub2RlSW50ZWdyYXRpb246IHRydWUsXHJcbiAgICB9LFxyXG4gICAgZnJhbWU6IGZhbHNlXHJcbiAgfSk7XHJcblxyXG4gIG1haW5XaW5kb3cubG9hZEZpbGUocGF0aC5yZXNvbHZlKHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9yZW5kZXJlci9pbmRleC5odG1sJykpKTtcclxuXHJcbiAgLy8gc2hvdyB3aW5kb3cgb25jZSBvbiBmaXJzdCBsb2FkXHJcbiAgbWFpbldpbmRvdy53ZWJDb250ZW50cy5vbmNlKCdkaWQtZmluaXNoLWxvYWQnLCAoKSA9PiB7XHJcbiAgICBtYWluV2luZG93LnNob3coKTtcclxuICB9KTtcclxuXHJcbiAgbWFpbldpbmRvdy53ZWJDb250ZW50cy5vbignZGlkLWZpbmlzaC1sb2FkJywgKCkgPT4ge1xyXG4gICAgLy8gSGFuZGxlIHdpbmRvdyBsb2dpYyBwcm9wZXJseSBvbiBtYWNPUzpcclxuICAgIC8vIDEuIEFwcCBzaG91bGQgbm90IHRlcm1pbmF0ZSBpZiB3aW5kb3cgaGFzIGJlZW4gY2xvc2VkXHJcbiAgICAvLyAyLiBDbGljayBvbiBpY29uIGluIGRvY2sgc2hvdWxkIHJlLW9wZW4gdGhlIHdpbmRvd1xyXG4gICAgLy8gMy4g4oyYK1Egc2hvdWxkIGNsb3NlIHRoZSB3aW5kb3cgYW5kIHF1aXQgdGhlIGFwcFxyXG4gICAgaWYgKHByb2Nlc3MucGxhdGZvcm0gPT09ICdkYXJ3aW4nKSB7XHJcbiAgICAgIG1haW5XaW5kb3cub24oJ2Nsb3NlJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoIWZvcmNlUXVpdCkge1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgbWFpbldpbmRvdy5oaWRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGFwcC5vbignYWN0aXZhdGUnLCAoKSA9PiB7XHJcbiAgICAgICAgbWFpbldpbmRvdy5zaG93KCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgYXBwLm9uKCdiZWZvcmUtcXVpdCcsICgpID0+IHtcclxuICAgICAgICBmb3JjZVF1aXQgPSB0cnVlO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIG1haW5XaW5kb3cub24oJ2Nsb3NlZCcsICgpID0+IHtcclxuICAgICAgICBtYWluV2luZG93ID0gbnVsbDtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGlmIChpc0RldmVsb3BtZW50KSB7XHJcbiAgICAvLyBhdXRvLW9wZW4gZGV2IHRvb2xzXHJcbiAgICBtYWluV2luZG93LndlYkNvbnRlbnRzLm9wZW5EZXZUb29scygpO1xyXG5cclxuICAgIC8vIGFkZCBpbnNwZWN0IGVsZW1lbnQgb24gcmlnaHQgY2xpY2sgbWVudVxyXG4gICAgbWFpbldpbmRvdy53ZWJDb250ZW50cy5vbignY29udGV4dC1tZW51JywgKGUsIHByb3BzKSA9PiB7XHJcbiAgICAgIE1lbnUuYnVpbGRGcm9tVGVtcGxhdGUoW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGxhYmVsOiAnSW5zcGVjdCBlbGVtZW50JyxcclxuICAgICAgICAgIGNsaWNrKCkge1xyXG4gICAgICAgICAgICBtYWluV2luZG93Lmluc3BlY3RFbGVtZW50KHByb3BzLngsIHByb3BzLnkpO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICBdKS5wb3B1cChtYWluV2luZG93KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgXHJcbn0pO1xyXG4iXSwiZmlsZSI6Im1haW4vaW5kZXguanMifQ==
